version: "3.8"

services:
  db:
    image: mysql:5.7
    environment:
      MYSQL_ROOT_PASSWORD: rootpassword # ğŸ” Reemplaza por una contraseÃ±a segura
      MYSQL_DATABASE: udeney_db
      MYSQL_USER: udeney_user
      MYSQL_PASSWORD: userpassword # ğŸ” Reemplaza por una contraseÃ±a segura
    volumes:
      - db_data:/var/lib/mysql # ğŸ“ Persistencia de la base de datos
    ports:
      - "3307:3306" # ğŸŒ Puerto MySQL accesible desde host

  backend:
    build:
      context: . # ğŸ“¦ Dockerfile del backend en raÃ­z
    command: python manage.py runserver 0.0.0.0:8000
    volumes:
      - .:/app # ğŸ” Monta el proyecto completo dentro del contenedor
    ports:
      - "8000:8000" # ğŸŒ Puerto de desarrollo de Django
    environment:
      DJANGO_SETTINGS_MODULE: e_commerce.settings
      PYTHONUNBUFFERED: 1
      DATABASE_HOST: db
      DATABASE_NAME: udeney_db
      DATABASE_USER: udeney_user
      DATABASE_PASSWORD: userpassword
    depends_on:
      - db # â³ Espera a que la base de datos estÃ© lista

  frontend:
    build:
      context: ./client # ğŸ“ Directorio donde estÃ¡ tu frontend con Vite
    command: npm run dev # ğŸš€ Lanza Vite en modo desarrollo
    working_dir: /app
    volumes:
      - ./client:/app # ğŸ” Monta el cÃ³digo para hot reload
      - /app/node_modules # âš ï¸ Evita sobrescribir node_modules dentro del contenedor
    ports:
      - "5173:5173" # ğŸŒ Puerto de desarrollo de Vite
    depends_on:
      - backend # â³ Espera a que el backend estÃ© disponible

volumes:
  db_data: # ğŸ’¾ Volumen para MySQL

